<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuraci√≥n Inicial - GymTrack</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .section-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        .section-header {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            padding: 1.5rem;
        }
        .btn-selection {
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 12px 20px;
            margin: 5px;
            text-align: left;
            transition: all 0.3s ease;
            background: white;
            cursor: pointer;
        }
        .btn-selection:hover {
            border-color: #007bff;
            background: #f8f9fa;
        }
        .btn-selection.active {
            border-color: #007bff;
            background: #007bff;
            color: white;
        }
        .btn-habito {
            border: 2px solid #dee2e6;
            border-radius: 25px;
            padding: 10px 20px;
            margin: 5px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .btn-habito.active {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }
        .btn-dia {
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 10px 15px;
            margin: 3px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .btn-dia.active {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }
        .btn-tipo-ejercicio {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 8px 12px;
            margin: 3px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .btn-tipo-ejercicio.active {
            border-color: #dc3545;
            background: #dc3545;
            color: white;
        }
        .btn-ejercicio {
            border: 1px solid #dee2e6;
            border-radius: 20px;
            padding: 6px 12px;
            margin: 2px;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .btn-ejercicio.active {
            border-color: #6f42c1;
            background: #6f42c1;
            color: white;
        }
        .counter-badge {
            background: #6c757d;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        .btn-submit {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 25px;
            font-weight: 600;
        }
        .selection-limit {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 1rem;
        }
        .dia-configuracion {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 2px solid #e9ecef;
        }
        .medida-card {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border: 1px solid #e9ecef;
        }
        .required::after {
            content: " *";
            color: #dc3545;
        }
        .is-invalid {
            border-color: #dc3545;
        }
        .invalid-feedback {
            display: block;
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        .info-text {
            font-size: 0.9rem;
            color: #6c757d;
            font-style: italic;
        }
        .config-dia-header {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .ejercicio-counter {
            font-size: 0.8rem;
            color: #6c757d;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <!-- Header -->
                <div class="text-center mb-5">
                    <h1 class="display-4 fw-bold text-primary">üéØ Configuraci√≥n Inicial</h1>
                    <p class="lead text-muted">Completa tu informaci√≥n para personalizar tu experiencia en GymTrack</p>
                </div>

                <form th:action="@{/configuracion-inicial/nuevo-usuario}" th:object="${configuracionInicial}" method="post" id="configForm">
                    <input type="hidden" th:field="*{usuarioId}">
                    <input type="hidden" name="objetivosPrincipales" id="objetivosPrincipales">
                    <input type="hidden" name="configuracionDias" id="configuracionDias">
                    <input type="hidden" name="habitosMetas" id="habitosMetas">

                    <!-- SECCI√ìN 1: OBJETIVOS PRINCIPALES -->
                    <div class="card section-card">
                        <div class="section-header">
                            <h2 class="h4 mb-0">üéØ Objetivos Principales</h2>
                        </div>
                        <div class="card-body">
                            <p class="selection-limit">Selecciona entre 1 y 4 objetivos principales <span id="objetivosCounter" class="counter-badge">0/4</span></p>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="PERDER_PESO">
                                        <strong>üìâ Perder peso</strong>
                                        <br><small>Reducir grasa corporal y peso total</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="GANAR_MASA">
                                        <strong>üí™ Ganar masa muscular</strong>
                                        <br><small>Aumentar volumen y fuerza muscular</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="TONIFICAR">
                                        <strong>‚ú® Tonificar</strong>
                                        <br><small>Definir m√∫sculos sin aumentar volumen</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="MEJORAR_SALUD">
                                        <strong>‚ù§Ô∏è Mejorar salud</strong>
                                        <br><small>Mejorar salud cardiovascular y general</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="MANTENER_PESO">
                                        <strong>‚öñÔ∏è Mantener peso</strong>
                                        <br><small>Conservar peso actual y tono muscular</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="AUMENTAR_FUERZA">
                                        <strong>üèãÔ∏è Aumentar fuerza</strong>
                                        <br><small>Incrementar capacidad de levantar peso</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="FORTALECER_ARTICULACIONES">
                                        <strong>ü¶µ Fortalecer articulaciones</strong>
                                        <br><small>Mejorar salud articular y movilidad</small>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="btn-selection" data-value="MEJORAR_RESISTENCIA">
                                        <strong>‚ö° Mejorar resistencia</strong>
                                        <br><small>Aumentar capacidad aer√≥bica y aguante</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PESOS Y MEDIDAS COMPLETAS -->
                    <div class="card section-card">
                        <div class="section-header">
                            <h2 class="h4 mb-0">üìä Pesos y Medidas Corporales</h2>
                        </div>
                        <div class="card-body">
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <label class="form-label required">Peso Actual (kg)</label>
                                    <input th:field="*{pesoInicial}" type="number" step="0.1" class="form-control" 
                                           placeholder="70.5" min="35" max="250" required>
                                    <small class="text-muted">M√≠n: 35kg - M√°x: 250kg</small>
                                    
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label required">Meta de Peso (kg)</label>
                                    <input th:field="*{metaPeso}" type="number" step="0.1" class="form-control" 
                                           placeholder="65.0" min="35" max="250" required>
                                    <small class="text-muted">M√≠n: 35kg - M√°x: 250kg</small>
                                    
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label required">Fecha Meta</label>
                                    <input th:field="*{metaFecha}" type="date" class="form-control" id="metaFecha" required>
                                    <div class="invalid-feedback" id="metaFechaError"></div>
                                    <small class="text-muted">M√≠nimo 1 mes - M√°ximo 12 meses desde hoy</small>
                                </div>
                            </div>

                            <h5 class="mb-3">üìè Medidas Corporales (cm)</h5>
                            
                            <!-- Brazo -->
                            <div class="medida-card">
                                <h6 class="fw-bold">üí™ Brazo</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <label class="form-label">Actual</label>
                                        <input th:field="*{medidaBrazoActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="35.5" min="15" max="80">
                                        <small class="text-muted">M√≠n: 15cm - M√°x: 80cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Objetivo</label>
                                        <input th:field="*{medidaBrazoObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="33.0" min="15" max="80">
                                        <small class="text-muted">M√≠n: 15cm - M√°x: 80cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">Meta</label>
                                        <select th:field="*{metaBrazo}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Abdomen -->
                            <div class="medida-card">
                                <h6 class="fw-bold">ü´Å Abdomen</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input th:field="*{medidaAbdomenActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="85.0" min="50" max="180">
                                        <small class="text-muted">M√≠n: 50cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input th:field="*{medidaAbdomenObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="78.0" min="50" max="180">
                                        <small class="text-muted">M√≠n: 50cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select th:field="*{metaAbdomen}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Cintura -->
                            <div class="medida-card">
                                <h6 class="fw-bold">üìê Cintura</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input th:field="*{medidaCinturaActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="80.0" min="50" max="180">
                                        <small class="text-muted">M√≠n: 50cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input th:field="*{medidaCinturaObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="75.0" min="50" max="180">
                                        <small class="text-muted">M√≠n: 50cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select th:field="*{metaCintura}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Cadera -->
                            <div class="medida-card">
                                <h6 class="fw-bold">üçë Cadera</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input th:field="*{medidaCaderaActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="95.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input th:field="*{medidaCaderaObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="90.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select th:field="*{metaCadera}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Muslo -->
                            <div class="medida-card">
                                <h6 class="fw-bold">ü¶µ Muslo</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input th:field="*{medidaMusloActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="55.0" min="30" max="100">
                                        <small class="text-muted">M√≠n: 30cm - M√°x: 100cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input th:field="*{medidaMusloObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="52.0" min="30" max="100">
                                        <small class="text-muted">M√≠n: 30cm - M√°x: 100cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select th:field="*{metaMuslo}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Pecho -->
                            <div class="medida-card">
                                <h6 class="fw-bold">ü´Ä Pecho</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input th:field="*{medidaPechoActual}" type="number" step="0.1" class="form-control" 
                                               placeholder="100.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input th:field="*{medidaPechoObjetivo}" type="number" step="0.1" class="form-control" 
                                               placeholder="105.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select th:field="*{metaPecho}" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Gl√∫teo -->
                            <div class="medida-card">
                                <h6 class="fw-bold">üî¥ Gl√∫teo</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <input name="medidaGluteoActual" type="number" step="0.1" class="form-control" 
                                               placeholder="98.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <input name="medidaGluteoObjetivo" type="number" step="0.1" class="form-control" 
                                               placeholder="102.0" min="60" max="180">
                                        <small class="text-muted">M√≠n: 60cm - M√°x: 180cm</small>
                                    </div>
                                    <div class="col-md-4">
                                        <select name="metaGluteo" class="form-select">
                                            <option value="">Selecciona meta</option>
                                            <option value="DISMINUIR_GRASA">üìâ Disminuir grasa</option>
                                            <option value="AUMENTAR_MASA">üìà Aumentar masa</option>
                                            <option value="TONIFICAR">‚ú® Tonificar</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- SECCI√ìN: CALOR√çAS DIARIAS -->
                            <div class="medida-card">
                                <h6 class="fw-bold">üî• Calor√≠as Diarias</h6>
                                <p class="info-text mb-3">
                                    Establece tu meta de calor√≠as diarias y registra un aproximado de consumo actual 
                                    para tener un control sin necesidad de medir todo diariamente.
                                </p>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Calor√≠as Actuales (aproximado)</label>
                                        <input th:field="*{caloriasActual}" type="number" class="form-control" 
                                               placeholder="2000" min="800" max="8000" required>
                                        <small class="text-muted">Calor√≠as diarias que consumes actualmente (800-8000)</small>
                                
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Meta de Calor√≠as Diarias</label>
                                        <input th:field="*{caloriasMeta}" type="number" class="form-control" 
                                               placeholder="1800" min="800" max="8000" required>
                                        <small class="text-muted">Calor√≠as diarias objetivo para tu meta (800-8000)</small>
                                
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-12">
                                        <label class="form-label">Objetivo de Calor√≠as</label>
                                        <select th:field="*{objetivoCalorias}" class="form-select" required>
                                            <option value="">Selecciona tu objetivo</option>
                                            <option value="DEFICIT">üìâ D√©ficit cal√≥rico (bajar de peso)</option>
                                            <option value="MANTENER">‚öñÔ∏è Mantener peso actual</option>
                                            <option value="SUPERAVIT">üìà Super√°vit cal√≥rico (ganar masa)</option>
                                        </select>
                                        <small class="text-muted">
                                            D√©ficit: Consumir menos calor√≠as de las que quemas<br>
                                            Mantener: Equilibrar consumo y gasto cal√≥rico<br>
                                            Super√°vit: Consumir m√°s calor√≠as de las que quemas
                                        </small>
                                    
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SECCI√ìN 2: ENTRENAMIENTO POR D√çA -->
                    <div class="card section-card">
                        <div class="section-header">
                            <h2 class="h4 mb-0">üèãÔ∏è Entrenamiento por D√≠a</h2>
                        </div>
                        <div class="card-body">
                            <!-- D√≠as de la semana -->
                            <div class="mb-4">
                                <label class="form-label required">Selecciona los d√≠as de entrenamiento</label>
                                <div class="d-flex flex-wrap">
                                    <button type="button" class="btn-dia" data-dia="LUNES">Lunes</button>
                                    <button type="button" class="btn-dia" data-dia="MARTES">Martes</button>
                                    <button type="button" class="btn-dia" data-dia="MIERCOLES">Mi√©rcoles</button>
                                    <button type="button" class="btn-dia" data-dia="JUEVES">Jueves</button>
                                    <button type="button" class="btn-dia" data-dia="VIERNES">Viernes</button>
                                    <button type="button" class="btn-dia" data-dia="SABADO">S√°bado</button>
                                    <button type="button" class="btn-dia" data-dia="DOMINGO">Domingo</button>
                                </div>
                            </div>

                            <!-- Configuraci√≥n por d√≠a -->
                            <div id="configuracionDiasContainer">
                                <!-- Aqu√≠ se generar√°n las configuraciones por d√≠a -->
                            </div>
                        </div>
                    </div>

                    <!-- SECCI√ìN 3: H√ÅBITOS Y METAS -->
                    <div class="card section-card">
                        <div class="section-header">
                            <h2 class="h4 mb-0">üíö H√°bitos y Metas</h2>
                        </div>
                        <div class="card-body">
                            <!-- Metas de H√°bitos -->
                            <div class="mb-4">
                                <label class="form-label">Metas de H√°bitos</label>
                                <p class="selection-limit">Selecciona las metas de h√°bitos que quieres lograr</p>
                                <div class="d-flex flex-wrap">
                                    <button type="button" class="btn-habito" data-habito="COMER_SALUDABLE">ü•ó Comer saludable</button>
                                    <button type="button" class="btn-habito" data-habito="BUENA_HIDRATACION">üíß Buena hidrataci√≥n</button>
                                    <button type="button" class="btn-habito" data-habito="BUEN_SUENIO">üò¥ Buen sue√±o</button>
                                    <button type="button" class="btn-habito" data-habito="EJERCICIO_REGULAR">üèÉ Ejercicio regular</button>
                                    <button type="button" class="btn-habito" data-habito="MANEJO_ESTRES">üßò Manejo del estr√©s</button>
                                </div>
                            </div>

                            <!-- H√°bitos Actuales -->
                            <div class="row">
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Desayuno</label>
                                    <select th:field="*{desayunoHabito}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="SALUDABLE">‚úÖ Saludable</option>
                                        <option value="NO_SALUDABLE">‚ùå No saludable</option>
                                        <option value="PARCIAL">‚ö†Ô∏è Parcial</option>
                                        <option value="OMITIDO">‚è≠Ô∏è Omitido</option>
                                    </select>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Almuerzo</label>
                                    <select th:field="*{almuerzoHabito}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="SALUDABLE">‚úÖ Saludable</option>
                                        <option value="NO_SALUDABLE">‚ùå No saludable</option>
                                        <option value="PARCIAL">‚ö†Ô∏è Parcial</option>
                                        <option value="OMITIDO">‚è≠Ô∏è Omitido</option>
                                    </select>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Cena</label>
                                    <select th:field="*{cenaHabito}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="SALUDABLE">‚úÖ Saludable</option>
                                        <option value="NO_SALUDABLE">‚ùå No saludable</option>
                                        <option value="PARCIAL">‚ö†Ô∏è Parcial</option>
                                        <option value="OMITIDO">‚è≠Ô∏è Omitido</option>
                                    </select>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Snack</label>
                                    <select th:field="*{snackHabito}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="SALUDABLE">‚úÖ Saludable</option>
                                        <option value="NO_SALUDABLE">‚ùå No saludable</option>
                                        <option value="PARCIAL">‚ö†Ô∏è Parcial</option>
                                        <option value="OMITIDO">‚è≠Ô∏è Omitido</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Bienestar -->
                            <div class="row">
                                <div class="col-md-4">
                                    <label class="form-label">Hidrataci√≥n Actual</label>
                                    <select th:field="*{hidratacionActual}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="POCA">üíß Poca</option>
                                        <option value="MODERADA">üíßüíß Moderada</option>
                                        <option value="BUENA">üíßüíßüíß Buena</option>
                                        <option value="EXCELENTE">üíßüíßüíßüíß Excelente</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Sue√±o Actual</label>
                                    <select th:field="*{suenioActual}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="MENOS_6H">üò¥ Menos de 6h</option>
                                        <option value="6_7H">üò¥ 6-7h</option>
                                        <option value="7_8H">üò¥ 7-8h</option>
                                        <option value="MAS_8H">üò¥ M√°s de 8h</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">√Ånimo Actual</label>
                                    <select th:field="*{animoActual}" class="form-select">
                                        <option value="">Selecciona</option>
                                        <option value="BAJO">üòû Bajo</option>
                                        <option value="REGULAR">üòê Regular</option>
                                        <option value="BUENO">üòä Bueno</option>
                                        <option value="EXCELENTE">üòÑ Excelente</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-submit btn-lg">
                            üöÄ Completar Configuraci√≥n
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variables globales
        let objetivosSeleccionados = [];
        let diasSeleccionados = [];
        let habitosMetasSeleccionados = [];
        let configuracionPorDia = {};

        // Tipos de ejercicio disponibles
        const tiposEjercicio = {
            'FUERZA': { icon: 'üí™', nombre: 'Fuerza' },
            'CARDIO': { icon: 'üèÉ', nombre: 'Cardio' },
            'FLEXIBILIDAD': { icon: 'üßò', nombre: 'Flexibilidad' },
            'AEROBICOS': { icon: 'üíÉ', nombre: 'Aer√≥bicos' },
            'RESISTENCIA': { icon: '‚ö°', nombre: 'Resistencia' },
            'MIXTO': { icon: 'üîÑ', nombre: 'Mixto' }
        };

        // Ejercicios por tipo
        const ejerciciosPorTipo = {
            'FUERZA': ['Sentadillas', 'Peso muerto', 'Press banca', 'Remo con barra', 'Curl b√≠ceps', 'Tr√≠ceps en polea', 'Zancadas', 'Elevaciones laterales', 'Plancha con peso'],
            'CARDIO': ['Trotar', 'Saltar lazo', 'Burpees', 'Cinta de correr', 'Bicicleta', 'Escalera', 'Stepper', 'Nataci√≥n', 'Boxeo'],
            'FLEXIBILIDAD': ['Estiramiento piernas', 'Estiramiento espalda', 'Yoga b√°sico', 'Pilates', 'Puente', 'Cobra stretch', 'Rotaciones de hombros', 'Estocadas din√°micas'],
            'AEROBICOS': ['Aer√≥bicos bajo impacto', 'Aer√≥bicos alto impacto', 'Jumping jacks', 'Step aerobics', 'Dance fitness', 'Kickboxing', 'Zumba'],
            'RESISTENCIA': ['Circuito pesas ligeras', 'Bandas el√°sticas', 'Remo intensivo', 'Carreras intervalos', 'Subir escaleras', 'Burpees resistencia', 'Saltos caja'],
            'MIXTO': ['Circuito Fuerza+Cardio', 'HIIT completo', 'Cross training', 'Entrenamiento funcional', 'Calistenia avanzada']
        };

        // L√≠mites de ejercicios por tipo
        const limitesEjerciciosPorTipo = {
            'FUERZA': 5,
            'CARDIO': 3,
            'FLEXIBILIDAD': 4,
            'AEROBICOS': 3,
            'RESISTENCIA': 4,
            'MIXTO': 3
        };

        // L√≠mite de tipos de ejercicio por d√≠a
        const limiteTiposPorDia = 3;

        document.addEventListener('DOMContentLoaded', function() {
            // Configurar validaci√≥n de fecha meta
            configurarValidacionFechaMeta();

            // Objetivos Principales (1-4)
            document.querySelectorAll('.btn-selection').forEach(btn => {
                btn.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        objetivosSeleccionados = objetivosSeleccionados.filter(v => v !== value);
                    } else {
                        if (objetivosSeleccionados.length < 4) {
                            this.classList.add('active');
                            objetivosSeleccionados.push(value);
                        } else {
                            alert('M√°ximo 4 objetivos permitidos');
                        }
                    }
                    actualizarContador('objetivosCounter', objetivosSeleccionados.length, 4);
                    document.getElementById('objetivosPrincipales').value = objetivosSeleccionados.join(',');
                });
            });

            // D√≠as de Entrenamiento
            document.querySelectorAll('.btn-dia').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dia = this.getAttribute('data-dia');
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        diasSeleccionados = diasSeleccionados.filter(d => d !== dia);
                        eliminarConfiguracionDia(dia);
                    } else {
                        this.classList.add('active');
                        diasSeleccionados.push(dia);
                        agregarConfiguracionDia(dia);
                    }
                    actualizarConfiguracionDias();
                });
            });

            // H√°bitos y Metas
            document.querySelectorAll('.btn-habito').forEach(btn => {
                btn.addEventListener('click', function() {
                    const habito = this.getAttribute('data-habito');
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        habitosMetasSeleccionados = habitosMetasSeleccionados.filter(h => h !== habito);
                    } else {
                        this.classList.add('active');
                        habitosMetasSeleccionados.push(habito);
                    }
                    document.getElementById('habitosMetas').value = habitosMetasSeleccionados.join(',');
                });
            });

            // Validaci√≥n del formulario
            document.getElementById('configForm').addEventListener('submit', function(e) {
                if (!validarFormularioCompleto()) {
                    e.preventDefault();
                }
            });

            // Validaci√≥n en tiempo real para campos num√©ricos
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener('blur', function() {
                    validarCampoNumerico(this);
                });
            });
        });

        function validarFormularioCompleto() {
            let valido = true;

            // Validar objetivos
            if (objetivosSeleccionados.length === 0 || objetivosSeleccionados.length > 4) {
                alert('Por favor selecciona entre 1 y 4 objetivos principales.');
                valido = false;
            }

            // Validar d√≠as de entrenamiento
            if (diasSeleccionados.length === 0) {
                alert('Por favor selecciona al menos un d√≠a de entrenamiento.');
                valido = false;
            }

            // Validar fecha meta
            if (!validarFechaMetaConfiguracion()) {
                valido = false;
            }

            // Validar que cada d√≠a tenga al menos un tipo de ejercicio
            for (const dia of diasSeleccionados) {
                const config = configuracionPorDia[dia];
                if (!config || !config.tiempo || !config.intensidad) {
                    alert(`Por favor completa la configuraci√≥n de tiempo e intensidad para ${dia}.`);
                    valido = false;
                    break;
                }
            }

            // Validar campos requeridos
            const camposRequeridos = document.querySelectorAll('[required]');
            for (const campo of camposRequeridos) {
                if (!campo.value.trim()) {
                    campo.classList.add('is-invalid');
                    valido = false;
                } else {
                    campo.classList.remove('is-invalid');
                }
            }

            return valido;
        }

        function validarCampoNumerico(campo) {
            const valor = parseFloat(campo.value);
            const min = parseFloat(campo.getAttribute('min'));
            const max = parseFloat(campo.getAttribute('max'));

            if (isNaN(valor) || valor < min || valor > max) {
                campo.classList.add('is-invalid');
                return false;
            } else {
                campo.classList.remove('is-invalid');
                return true;
            }
        }

        // Configurar validaci√≥n para fecha meta en configuraci√≥n inicial
        function configurarValidacionFechaMeta() {
            const fechaMetaInput = document.getElementById('metaFecha');
            if (fechaMetaInput) {
                // Establecer atributos min y max para el input date
                const hoy = new Date();
                const minFecha = new Date();
                minFecha.setDate(hoy.getDate() + 30); // M√≠nimo 30 d√≠as (1 mes)
                const maxFecha = new Date();
                maxFecha.setMonth(hoy.getMonth() + 12);
                
                const minFechaStr = minFecha.toISOString().split('T')[0];
                const maxFechaStr = maxFecha.toISOString().split('T')[0];
                
                fechaMetaInput.setAttribute('min', minFechaStr);
                fechaMetaInput.setAttribute('max', maxFechaStr);
                
                fechaMetaInput.addEventListener('blur', validarFechaMetaConfiguracion);
                fechaMetaInput.addEventListener('input', function() { 
                    limpiarValidacionFechaMeta();
                });
            }
        }

        function validarFechaMetaConfiguracion() {
            const campo = document.getElementById('metaFecha');
            if (!campo) return true;
            
            const valor = campo.value;
            limpiarValidacionFechaMeta();

            if (!valor) { 
                mostrarErrorFechaMeta('La fecha meta no puede estar vac√≠a');
                return false; 
            }
            
            const fechaMeta = new Date(valor);
            const hoy = new Date();
            const minFecha = new Date();
            minFecha.setDate(hoy.getDate() + 30); // M√≠nimo 30 d√≠as (1 mes)
            const maxFecha = new Date();
            maxFecha.setMonth(hoy.getMonth() + 12); // 12 meses m√°ximo
            
            // Validar que la fecha no sea anterior al m√≠nimo (1 mes)
            if (fechaMeta < minFecha) {
                mostrarErrorFechaMeta('La fecha meta debe ser al menos 1 mes (30 d√≠as) a partir de hoy');
                return false;
            }
            
            // Validar que no sea mayor a 12 meses
            if (fechaMeta > maxFecha) {
                mostrarErrorFechaMeta('La fecha meta no puede ser mayor a 12 meses desde hoy');
                return false;
            }

            campo.classList.add('is-valid');
            return true;
        }

        function limpiarValidacionFechaMeta() {
            const campo = document.getElementById('metaFecha');
            if (campo) {
                campo.classList.remove('is-invalid', 'is-valid');
                const errorDiv = document.getElementById('metaFechaError');
                if (errorDiv) {
                    errorDiv.textContent = '';
                }
            }
        }

        function mostrarErrorFechaMeta(mensaje) {
            const campo = document.getElementById('metaFecha');
            const errorDiv = document.getElementById('metaFechaError');
            if (campo && errorDiv) {
                campo.classList.add('is-invalid');
                campo.classList.remove('is-valid');
                errorDiv.textContent = mensaje;
            }
        }

        function agregarConfiguracionDia(dia) {
            const container = document.getElementById('configuracionDiasContainer');
            
            const diaDiv = document.createElement('div');
            diaDiv.className = 'dia-configuracion';
            diaDiv.id = `config-${dia}`;
            diaDiv.innerHTML = `
                <div class="config-dia-header">
                    <h5 class="fw-bold text-primary mb-3">${dia} <span class="counter-badge" id="contador-tipos-${dia}">0/${limiteTiposPorDia}</span></h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label required">Tiempo promedio </label>
                            <select class="form-select tiempo-sesion" data-dia="${dia}" required>
                                <option value="">Selecciona tiempo</option>
                                <option value="30">30 minutos</option>
                                <option value="45">45 minutos</option>
                                <option value="60">60 minutos</option>
                                <option value="90">90 minutos</option>
                                <option value="120">120 minutos</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required">Intensidad </label>
                            <select class="form-select intensidad" data-dia="${dia}" required>
                                <option value="">Selecciona intensidad</option>
                                <option value="BAJA">üü¢ Baja</option>
                                <option value="MEDIA">üü° Media</option>
                                <option value="ALTA">üî¥ Alta</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Tipos de ejercicio (m√°ximo 3)</label>
                    <div class="d-flex flex-wrap mb-2" id="tipos-${dia}">
                        ${Object.entries(tiposEjercicio).map(([key, tipo]) => `
                            <button type="button" class="btn-tipo-ejercicio" data-dia="${dia}" data-tipo="${key}">
                                ${tipo.icon} ${tipo.nombre}
                            </button>
                        `).join('')}
                    </div>
                </div>
                <div id="ejercicios-${dia}" class="ejercicios-container">
                    <p class="text-muted">Selecciona al menos un tipo de ejercicio para ver los ejercicios disponibles</p>
                </div>
            `;
            
            container.appendChild(diaDiv);
            
            // Configurar eventos para los tipos de ejercicio de este d√≠a
            document.querySelectorAll(`#tipos-${dia} .btn-tipo-ejercicio`).forEach(btn => {
                btn.addEventListener('click', function() {
                    const diaBtn = this.getAttribute('data-dia');
                    const tipo = this.getAttribute('data-tipo');
                    
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        if (configuracionPorDia[diaBtn]) {
                            configuracionPorDia[diaBtn].tipos = configuracionPorDia[diaBtn].tipos.filter(t => t !== tipo);
                        }
                    } else {
                        // Verificar que no se exceda el l√≠mite de tipos por d√≠a
                        if (configuracionPorDia[diaBtn] && configuracionPorDia[diaBtn].tipos.length >= limiteTiposPorDia) {
                            alert(`Solo puedes seleccionar hasta ${limiteTiposPorDia} tipos de ejercicio por d√≠a.`);
                            return;
                        }
                        this.classList.add('active');
                        if (!configuracionPorDia[diaBtn]) {
                            configuracionPorDia[diaBtn] = { 
                                tipos: [], 
                                ejercicios: {}, 
                                tiempo: '', 
                                intensidad: '' 
                            };
                        }
                        configuracionPorDia[diaBtn].tipos.push(tipo);
                    }
                    
                    actualizarContadorTipos(diaBtn);
                    mostrarEjerciciosParaDia(diaBtn);
                    actualizarConfiguracionDias();
                });
            });

            // Configurar eventos para tiempo e intensidad
            const selectTiempo = diaDiv.querySelector('.tiempo-sesion');
            const selectIntensidad = diaDiv.querySelector('.intensidad');

            selectTiempo.addEventListener('change', function() {
                const diaBtn = this.getAttribute('data-dia');
                if (!configuracionPorDia[diaBtn]) {
                    configuracionPorDia[diaBtn] = { tipos: [], ejercicios: {}, tiempo: '', intensidad: '' };
                }
                configuracionPorDia[diaBtn].tiempo = this.value;
                actualizarConfiguracionDias();
                
                // Validaci√≥n visual
                if (this.value) {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                } else {
                    this.classList.add('is-invalid');
                    this.classList.remove('is-valid');
                }
            });

            selectIntensidad.addEventListener('change', function() {
                const diaBtn = this.getAttribute('data-dia');
                if (!configuracionPorDia[diaBtn]) {
                    configuracionPorDia[diaBtn] = { tipos: [], ejercicios: {}, tiempo: '', intensidad: '' };
                }
                configuracionPorDia[diaBtn].intensidad = this.value;
                actualizarConfiguracionDias();
                
                // Validaci√≥n visual
                if (this.value) {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                } else {
                    this.classList.add('is-invalid');
                    this.classList.remove('is-valid');
                }
            });
        }

        function actualizarContadorTipos(dia) {
            const contador = document.getElementById(`contador-tipos-${dia}`);
            if (contador && configuracionPorDia[dia]) {
                const cantidad = configuracionPorDia[dia].tipos.length;
                contador.textContent = `${cantidad}/${limiteTiposPorDia}`;
                
                // Cambiar color seg√∫n la cantidad
                if (cantidad >= limiteTiposPorDia) {
                    contador.style.background = '#dc3545';
                } else if (cantidad === 0) {
                    contador.style.background = '#ffc107';
                } else {
                    contador.style.background = '#28a745';
                }
            }
        }

        function mostrarEjerciciosParaDia(dia) {
            const container = document.getElementById(`ejercicios-${dia}`);
            const config = configuracionPorDia[dia];
            
            if (!config || config.tipos.length === 0) {
                container.innerHTML = '<p class="text-muted">Selecciona al menos un tipo de ejercicio para ver los ejercicios disponibles</p>';
                return;
            }
            
            let html = '';
            config.tipos.forEach(tipo => {
                const ejerciciosSeleccionados = config.ejercicios[tipo] || [];
                const limite = limitesEjerciciosPorTipo[tipo] || 5;
                html += `
                    <div class="mb-3">
                        <h6 class="fw-bold">${tiposEjercicio[tipo].icon} ${tiposEjercicio[tipo].nombre} 
                            <span class="ejercicio-counter">(${ejerciciosSeleccionados.length}/${limite})</span>
                        </h6>
                        <div class="d-flex flex-wrap">
                            ${ejerciciosPorTipo[tipo].map(ejercicio => {
                                const ejercicioKey = ejercicio.toUpperCase().replace(/ /g, '_');
                                const estaSeleccionado = ejerciciosSeleccionados.includes(ejercicioKey);
                                return `
                                    <button type="button" class="btn-ejercicio ${estaSeleccionado ? 'active' : ''}" 
                                            data-dia="${dia}" data-tipo="${tipo}" data-ejercicio="${ejercicioKey}">
                                        ${ejercicio}
                                    </button>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Configurar eventos para los ejercicios
            container.querySelectorAll('.btn-ejercicio').forEach(btn => {
                btn.addEventListener('click', function() {
                    const diaEj = this.getAttribute('data-dia');
                    const tipo = this.getAttribute('data-tipo');
                    const ejercicio = this.getAttribute('data-ejercicio');
                    
                    if (!configuracionPorDia[diaEj].ejercicios[tipo]) {
                        configuracionPorDia[diaEj].ejercicios[tipo] = [];
                    }
                    
                    const ejerciciosDelTipo = configuracionPorDia[diaEj].ejercicios[tipo];
                    const limite = limitesEjerciciosPorTipo[tipo] || 5;
                    
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        configuracionPorDia[diaEj].ejercicios[tipo] = ejerciciosDelTipo.filter(e => e !== ejercicio);
                    } else {
                        // Verificar que no se exceda el l√≠mite de ejercicios para este tipo
                        if (ejerciciosDelTipo.length >= limite) {
                            alert(`Solo puedes seleccionar hasta ${limite} ejercicios de tipo ${tiposEjercicio[tipo].nombre}.`);
                            return;
                        }
                        this.classList.add('active');
                        configuracionPorDia[diaEj].ejercicios[tipo].push(ejercicio);
                    }
                    
                    // Actualizar el contador de ejercicios para este tipo
                    actualizarContadorEjercicios(diaEj, tipo);
                    actualizarConfiguracionDias();
                });
            });
        }

        function actualizarContadorEjercicios(dia, tipo) {
            const contador = document.querySelector(`#ejercicios-${dia} h6[data-tipo="${tipo}"] .ejercicio-counter`);
            if (contador) {
                const ejerciciosSeleccionados = configuracionPorDia[dia].ejercicios[tipo] || [];
                const limite = limitesEjerciciosPorTipo[tipo] || 5;
                contador.textContent = `(${ejerciciosSeleccionados.length}/${limite})`;
            }
        }

        function eliminarConfiguracionDia(dia) {
            const elemento = document.getElementById(`config-${dia}`);
            if (elemento) {
                elemento.remove();
            }
            delete configuracionPorDia[dia];
        }

        function actualizarConfiguracionDias() {
            document.getElementById('configuracionDias').value = JSON.stringify(configuracionPorDia);
        }

        function actualizarContador(elementId, actual, maximo) {
            const elemento = document.getElementById(elementId);
            elemento.textContent = `${actual}/${maximo}`;
            if (actual >= maximo) {
                elemento.style.background = '#dc3545';
            } else if (actual === 0) {
                elemento.style.background = '#ffc107';
            } else {
                elemento.style.background = '#28a745';
            }
        }
    </script>
</body>
</html>